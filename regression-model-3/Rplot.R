library(ggplot2)
library(tidyr)

PENN_ZI = c(0.8981430530548096, 0.9179642796516418, 0.8719450235366821, 0.8891510963439941, 0.8471472859382629, 0.931098222732544, 0.9088613390922546, 0.85178142786026, 0.9935603737831116, 0.9996105432510376, 0.8995017409324646, 0.9290486574172974, 0.9031370878219604, 0.8957374095916748, 1.0013478994369507, 0.9773666262626648, 0.9057207107543945, 0.8906202912330627, 0.9054656028747559, 0.8931309580802917, 0.9055522680282593, 0.9371340870857239, 0.9447075128555298, 0.8910856246948242, 0.9396334886550903, 0.879650890827179, 0.892600417137146, 0.9991257786750793, 0.853626549243927, 0.899844229221344, 1.0603020191192627, 0.8567478656768799, 1.0143862962722778, 0.8807156085968018, 0.9175353646278381, 0.8916091918945312, 0.8761974573135376, 0.891528308391571, 0.9473190307617188, 0.9300574064254761, 0.9988600611686707, 0.9161072373390198, 0.9636011719703674, 0.8887673616409302, 0.909341037273407, 0.9064801931381226, 0.9776756763458252, 0.8508652448654175, 0.9206567406654358, 0.9140392541885376, 0.904786229133606, 1.0108611583709717, 0.8562504053115845, 0.865617573261261, 0.8930495977401733, 0.8887737989425659, 0.9464021325111389, 0.9243444204330444, 0.8923313617706299, 0.9065456986427307, 0.9203923940658569, 0.9178910255432129, 0.9514868259429932, 0.8577574491500854, 0.9160188436508179, 1.0104621648788452, 0.9901244044303894, 0.8902503848075867, 0.8953331112861633, 0.951202929019928, 0.878387987613678, 1.1108859777450562, 0.9751372933387756, 0.9344590902328491, 0.8558092713356018, 0.9121066331863403, 0.8972010016441345, 0.9500240087509155, 0.849419116973877, 0.9150005578994751, 0.9495694041252136, 0.9234029054641724, 0.9853662252426147, 0.8856242299079895, 0.8484928011894226, 0.9252944588661194, 0.9460891485214233, 0.8966972827911377, 0.8342338800430298, 0.9594048857688904, 0.8926125764846802, 0.8944607377052307, 0.9552436470985413, 0.9579041004180908, 0.8341948986053467, 0.9011351466178894, 1.00978422164917, 0.9087114334106445, 0.891543447971344, 0.900867760181427) - 0.5236 - 0.25

NN_ZI = c(1.0285301208496094, 0.9749572277069092, 0.9495732188224792, 1.0852031707763672, 1.0258742570877075, 1.019879937171936, 1.0074220895767212, 1.0263911485671997, 1.025162696838379, 1.050432562828064, 1.0191011428833008, 1.0261379480361938, 1.0297545194625854, 1.0200010538101196, 1.0814987421035767, 0.9939532279968262, 1.009804606437683, 0.943695604801178, 0.9725736379623413, 1.0042262077331543, 1.0044124126434326, 1.0387805700302124, 1.0088030099868774, 1.0404243469238281, 0.9759887456893921, 0.9925470948219299, 1.024596095085144, 1.0247492790222168, 1.0845609903335571, 1.0429497957229614, 1.055828332901001, 1.0122623443603516, 1.0567482709884644, 1.0265699625015259, 1.03047513961792, 1.0089137554168701, 1.0651593208312988, 1.0455931425094604, 1.00687837600708, 1.059706211090088, 1.0661544799804688, 1.0223528146743774, 1.0172446966171265, 1.0227460861206055, 1.0174604654312134, 1.0156315565109253, 1.0336965322494507, 1.0322272777557373, 0.9723886847496033, 1.0545127391815186, 1.063052773475647, 1.0722581148147583, 0.9901195168495178, 1.0355546474456787, 1.0172845125198364, 1.0744117498397827, 1.0859313011169434, 1.0822328329086304, 1.1098443269729614, 1.0285080671310425, 1.0081961154937744, 1.034538984298706, 1.0947377681732178, 1.005500078201294, 1.010970115661621, 0.9950564503669739, 1.0395363569259644, 1.0306477546691895, 1.0454974174499512, 0.9978573322296143, 1.0399644374847412, 1.0324623584747314, 1.0421507358551025, 1.0191632509231567, 0.9835841059684753, 1.0333943367004395, 1.0633689165115356, 1.0295969247817993, 1.0061239004135132, 1.054089069366455, 1.0660854578018188, 1.0170183181762695, 1.0179574489593506, 1.085968017578125, 0.9966558814048767, 0.9678615927696228, 1.0282806158065796, 1.060560703277588, 1.0133986473083496, 1.0833990573883057, 0.9989176988601685, 1.0313661098480225, 1.058627963066101, 1.0265856981277466, 0.9635530114173889, 1.0284276008605957, 1.0265367031097412, 1.0963369607925415, 1.011352777481079, 1.0058575868606567) - 0.5236 - 0.25 

PENN_MF = c(0.9502116441726685, 0.9084093570709229, 0.9931526184082031, 0.9349477291107178, 1.023658037185669, 0.9127238988876343, 0.9393681883811951, 0.9635742902755737, 0.9028569459915161, 0.9286973476409912, 0.8711751699447632, 0.9405534267425537, 0.9492233395576477, 1.0242514610290527, 0.933876633644104, 0.8866378664970398, 1.1027477979660034, 0.9292463064193726, 0.9234132766723633, 0.9275219440460205, 0.8929771780967712, 0.9483951330184937, 0.9444286227226257, 0.9743754863739014, 0.8963448405265808, 0.9508382081985474, 0.9612061381340027, 1.1462643146514893, 0.9753751754760742, 0.9182232618331909, 0.8879359364509583, 0.9777414202690125, 0.9825847744941711, 0.9544582962989807, 0.8856005668640137, 0.9194392561912537, 1.0674986839294434, 0.9136257767677307, 0.8827150464057922, 1.0755515098571777, 0.9228503108024597, 1.0448341369628906, 0.9219531416893005, 1.1068769693374634, 0.9554400444030762, 0.9046061635017395, 1.073322057723999, 0.8458372950553894, 0.8755626082420349, 1.0754942893981934, 0.9857501983642578, 1.049116849899292, 1.054160714149475, 1.0955190658569336, 0.9138284921646118, 1.069750428199768, 0.9188923835754395, 0.9831214547157288, 0.9039121270179749, 0.9950318336486816, 0.9684494137763977, 1.012674331665039, 0.9415819048881531, 0.8753094673156738, 1.1303414106369019, 0.9126474857330322, 0.9022233486175537, 0.9234523177146912, 0.9324686527252197, 0.950774610042572, 1.0875959396362305, 0.9401062726974487, 0.9287468791007996, 0.9882795810699463, 0.9424874782562256, 0.9449594020843506, 0.9410761594772339, 0.8878660202026367, 0.8861382007598877, 1.0179492235183716, 0.9283453226089478, 1.0820010900497437, 1.0031989812850952, 0.9421428442001343, 1.0894510746002197, 0.9013070464134216, 0.9401006698608398, 1.0719594955444336, 1.0171144008636475, 0.9514601826667786, 1.01497220993042, 0.9667755961418152, 0.9760875105857849, 0.9649633765220642, 0.8003181219100952, 1.060375452041626, 1.1217567920684814, 0.9179880023002625, 1.0335062742233276, 0.9134443402290344) - 0.5236 - 0.25 

NN_MF = c(1.6645333766937256, 1.6850172281265259, 1.679581880569458, 1.6837149858474731, 1.7220312356948853, 1.761834979057312, 1.7414722442626953, 1.642422080039978, 1.7231972217559814, 1.6613062620162964, 1.6625466346740723, 1.7020578384399414, 1.7118054628372192, 1.6596925258636475, 1.7132171392440796, 1.7451605796813965, 1.6337262392044067, 1.6947747468948364, 1.6775373220443726, 1.6187762022018433, 1.6986720561981201, 1.7513039112091064, 1.7168457508087158, 1.7763711214065552, 1.6264065504074097, 1.7306936979293823, 1.812718391418457, 1.669429898262024, 1.746690273284912, 1.6851133108139038, 1.7128511667251587, 1.788285493850708, 1.7023332118988037, 1.682051181793213, 1.6327224969863892, 1.758871078491211, 1.7547820806503296, 1.6926153898239136, 1.7035502195358276, 1.7466379404067993, 1.6725400686264038, 1.664060354232788, 1.7283812761306763, 1.7289907932281494, 1.6429672241210938, 1.7121524810791016, 1.692232370376587, 1.6384748220443726, 1.716923475265503, 1.7069242000579834, 1.776615023612976, 1.667744517326355, 1.7028881311416626, 1.717939019203186, 1.7379437685012817, 1.734164834022522, 1.60788893699646, 1.6969048976898193, 1.7197922468185425, 1.6595011949539185, 1.730180025100708, 1.6807870864868164, 1.8570566177368164, 1.6950955390930176, 1.7091621160507202, 1.6738804578781128, 1.7216875553131104, 1.6816482543945312, 1.673026204109192, 1.7101924419403076, 1.7083640098571777, 1.6974595785140991, 1.7371023893356323, 1.763452172279358, 1.6917636394500732, 1.713878870010376, 1.694210171699524, 1.7291650772094727, 1.5915714502334595, 1.6744384765625, 1.7035624980926514, 1.6577086448669434, 1.7829734086990356, 1.7178713083267212, 1.6735068559646606, 1.7174140214920044, 1.7009130716323853, 1.70279061794281, 1.6833101511001587, 1.6930978298187256, 1.707737922668457, 1.7158443927764893, 1.77193021774292, 1.7577840089797974, 1.6674712896347046, 1.7023353576660156, 1.6834156513214111, 1.690321445465088, 1.7052372694015503, 1.6173676252365112) - 0.5236 - 0.25 

PENN_MICE = c(0.8721635937690735, 0.912061333656311, 0.8567931652069092, 0.9349062442779541, 0.8626223802566528, 0.9060147404670715, 0.9136471748352051, 0.8404947519302368, 0.9634172916412354, 0.9493167996406555, 0.9059772491455078, 0.9070804715156555, 0.9791086912155151, 0.9253048896789551, 0.9584223628044128, 0.9285968542098999, 0.9100251197814941, 0.8571417927742004, 0.9997610449790955, 0.9058847427368164, 0.9028947353363037, 0.9380254745483398, 0.8850542902946472, 0.9630011916160583, 0.8622075319290161, 0.966605544090271, 0.895479679107666, 0.8888519406318665, 0.9313275218009949, 0.8824799656867981, 0.9061543941497803, 1.0230748653411865, 0.9113785028457642, 0.9340197443962097, 0.8860269784927368, 0.8808898329734802, 0.9013969898223877, 0.930709183216095, 0.9044862985610962, 0.9515279531478882, 0.9097356200218201, 0.9061203002929688, 0.9387456178665161, 0.9166378974914551, 0.9153313636779785, 0.9103752970695496, 0.9447301626205444, 0.9818298816680908, 0.9591810703277588, 0.9157974720001221, 0.9727820158004761, 0.8890851736068726, 0.9004002809524536, 0.8921284079551697, 0.8963359594345093, 0.8594202399253845, 0.9976944327354431, 0.8574717044830322, 0.9751926064491272, 0.9187169075012207, 0.8752188682556152, 0.9285922050476074, 1.0139129161834717, 0.8889217972755432, 0.9647318124771118, 0.8725180625915527, 1.0150529146194458, 1.0245441198349, 0.9062024354934692, 0.8726338148117065, 0.8873454332351685, 0.8963062763214111, 1.0069634914398193, 0.8619240522384644, 1.010055422782898, 0.935667097568512, 0.9244179725646973, 1.0598701238632202, 0.9223028421401978, 0.8675845861434937, 0.9980372786521912, 0.934643566608429, 0.897229015827179, 1.0508129596710205, 0.8590456247329712, 0.8820886611938477, 0.9211940169334412, 0.9148527383804321, 0.9324487447738647, 0.9408697485923767, 0.8514202237129211, 0.8678767681121826, 1.0322932004928589, 0.9404006004333496, 0.8784988522529602, 0.9413880705833435, 0.9714237451553345, 0.9151769280433655, 0.9324516654014587, 0.986501932144165) - 0.5236 - 0.25 

NN_MICE = c(1.0532439947128296, 1.0776256322860718, 1.0518873929977417, 1.077609658241272, 1.0467356443405151, 1.0652971267700195, 1.0438990592956543, 1.0345090627670288, 1.045589566230774, 1.0474982261657715, 1.041257381439209, 1.0535519123077393, 1.0428637266159058, 1.025551199913025, 1.0943677425384521, 1.037060022354126, 1.0833709239959717, 1.047691822052002, 1.0273982286453247, 1.0703381299972534, 1.1097874641418457, 1.087387204170227, 1.083571434020996, 1.0770984888076782, 1.0266907215118408, 1.0581622123718262, 1.0363945960998535, 1.0567187070846558, 1.0841573476791382, 0.9976754188537598, 1.083616852760315, 1.040465235710144, 1.043778896331787, 1.0922725200653076, 1.0527098178863525, 1.0376983880996704, 1.0451842546463013, 1.0232634544372559, 1.0380829572677612, 1.0555224418640137, 1.0456815958023071, 1.0313546657562256, 0.9845478534698486, 1.0519682168960571, 1.0072784423828125, 1.0870215892791748, 1.1130470037460327, 1.0159540176391602, 1.0333346128463745, 1.0300623178482056, 1.1185137033462524, 1.1388429403305054, 1.061607003211975, 0.993211030960083, 1.050592064857483, 1.0345299243927002, 1.0532103776931763, 1.07058584690094, 1.1097497940063477, 1.0313913822174072, 1.0438863039016724, 1.058430552482605, 1.1346955299377441, 1.0083045959472656, 1.0632758140563965, 1.060484528541565, 1.0777541399002075, 1.0893703699111938, 1.0944863557815552, 1.0546493530273438, 1.0766797065734863, 1.050395131111145, 1.0092750787734985, 1.101084589958191, 1.0664643049240112, 1.0550023317337036, 1.0632658004760742, 1.0505234003067017, 1.0617589950561523, 1.0138777494430542, 1.051155686378479, 1.0517897605895996, 1.1043343544006348, 1.0506490468978882, 1.014492154121399, 1.0244250297546387, 1.0474681854248047, 1.0305163860321045, 1.0061235427856445, 1.0354666709899902, 0.9982943534851074, 1.035579800605774, 1.1607965230941772, 1.1322988271713257, 1.0271894931793213, 1.0905855894088745, 1.0567448139190674, 1.0316396951675415, 1.0099536180496216, 1.0113552808761597) - 0.5236 - 0.25 
Excess_Risk = data.frame('PENN_ZI' = PENN_ZI, 'NN_ZI' = NN_ZI,
                         'PENN_MF' = PENN_MF, 'NN_MF' = NN_MF,
                         'PENN_MICE' = PENN_MICE, 'NN_MICE' = NN_MICE)

df_long = Excess_Risk %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PENN_ZI', 'NN_ZI', 'PENN_MF', 'NN_MF', 'PENN_MICE', 'NN_MICE'))

ggplot(df_long, aes(x=Variable, y=Value, fill=Variable)) + geom_boxplot(alpha=0.2) + 
  xlab("") + ylab("Excess risk") + theme_bw() + theme(legend.position = "none", text = element_text(size = 18)) + 
  scale_fill_manual(values = c('PENN_ZI' = 'red', 'NN_ZI' = 'blue', 'PENN_MF' = 'red', 
                               'NN_MF' = 'blue',  'PENN_MICE' = 'red', 'NN_MICE' = 'blue'))

