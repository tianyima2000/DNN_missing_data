x1 = runif(10000000)
x2 = runif(10000000)
x3 = runif(10000000)
(2 * mean((exp((x2+x3)/2) + (4*x3-2)^2 - 1.297437*exp(x2/2) - 1.333228)^2) +
  2 * mean((exp((x2+x3)/2) - 1.297437*exp(x3/2))^2) + 3*0.1500172 + 
  var(exp((x2+x3)/2) + (4*x3-2)^2) + var(2*x1^(1/3) + exp((x2+x3)/2) + 
  (4*x3-2)^2)) / 8



library(ggplot2)
library(tidyr)

### model 1, d = 10, lambda = 0.002
ER = data.frame('PA' = c(0.0242607593536377, 0.0806679725646973, 0.0229102969169617, 0.0501765012741089, 0.0413554906845093, 0.0399764776229858, 0.0524237751960754, 0.0294238328933716, 0.0321440696716309, 0.0303142666816711, 0.124454200267792, 0.0488192439079285, 0.113536059856415, 0.0197805762290955, 0.0723903179168701, 0.000502169132232666, -0.00586152076721191, 0.0635548830032349, -0.00456416606903076, 0.0244720578193665),
                'MI' = c(0.222686648368835, 0.19123911857605, 0.178280591964722, 0.220697164535522, 0.11268949508667, 0.166939258575439, 0.193582892417908, 0.117535293102264, 0.208900809288025, 0.213268876075745, 0.271273970603943, 0.21385657787323, 0.22545313835144, 0.10504162311554, 0.210767030715942, 0.178670763969421, 0.123692393302917, 0.252740979194641, 0.0534277558326721, 0.197497963905334),
                'MF' = c(0.285883784294128, 0.232636332511902, 0.233873009681702, 0.221532702445984, 0.211032509803772, 0.231446862220764, 0.219472527503967, 0.214640974998474, 0.223742842674255, 0.214550137519836, 0.26690149307251, 0.230428099632263, 0.225990653038025, 0.268933892250061, 0.216144800186157, 0.199579834938049, 0.192973613739014, 0.253745555877686, 0.17179274559021, 0.197360634803772))

df_long = ER %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PA', 'MI', 'MF'))

ggplot(df_long, aes(x=Variable, y=Value)) + geom_boxplot(fill="blue", alpha=0.2) + 
  xlab("") + ylab("Excess Risk")



### model 1, d = 10, lambda = 0
ER = data.frame('PA' = c(0.06037289, 0.0018065 , 0.03488708, 0.03395748, 0.0365774 , 0.0554406 ,
                         0.0703308 , 0.08812231, 0.0826602 , 0.05452174, 0.0452221 , 0.05278933,
                         0.04230219, 0.05850506, 0.06324959, 0.08542299, 0.06364501, 0.01990348,
                         0.09689593, 0.0329141),
                'MI' = c(0.07750809, 0.07230872, 0.14900321, 0.07624233, 0.09278011, 0.16184765,
                         0.08407956, 0.22008151, 0.04987603, 0.07757044, 0.21502608, 0.12579012,
                         0.20843619, 0.17563516, 0.14611799, 0.11678529, 0.15210992, 0.13371092,
                         0.23115081, 0.12282264),
                'MF' = c(0.21101421, 0.20760351, 0.22670203, 0.23798066, 0.20172077, 0.22265977,
                         0.2298041 , 0.23969573, 0.21746057, 0.21873456, 0.22091383, 0.26199692,
                         0.21043152, 0.25341159, 0.26742405, 0.27197212, 0.24592227, 0.20074373,
                         0.26125377, 0.22623104))

df_long = ER %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PA', 'MI', 'MF'))

ggplot(df_long, aes(x=Variable, y=Value)) + geom_boxplot(fill="blue", alpha=0.2) + 
  xlab("") + ylab("Excess Risk")



### model 1, d = 50, lambda = 0.003
ER = data.frame('PA' = c(0.04097778, 0.02024794, 0.05845785, 0.13843817, 0.06455338, 0.08535707,
                         0.14295441, 0.07582718, 0.09654808, 0.06687731, 0.04248279, 0.05933386,
                         0.07902312, 0.14073068, 0.11072731, 0.08436108, 0.06516278, 0.03213394,
                         0.07518959, 0.02230126),
                'MI' = c(0.32934958, 0.21589214, 0.22709793, 0.25703853, 0.20169824, 0.19860262,
                         0.26043195, 0.22022742, 0.22807711, 0.25496525, 0.28965694, 0.2348364 ,
                         0.22220594, 0.33198911, 0.29555577, 0.25381333, 0.28271848, 0.20263106,
                         0.25582153, 0.23755795),
                'MF' = c(0.24454242, 0.23105937, 0.22826988, 0.23900181, 0.23899895, 0.29680938,
                         0.26634902, 0.21124262, 0.27094454, 0.24375802, 0.21567208, 0.26289827,
                         0.22861022, 0.23342103, 0.27368838, 0.29897219, 0.28815669, 0.29497474,
                         0.2766934 , 0.19894832))

df_long = ER %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PA', 'MI', 'MF'))

ggplot(df_long, aes(x=Variable, y=Value)) + geom_boxplot(fill="blue", alpha=0.2) + 
  xlab("") + ylab("Excess Risk")



### model 1, d = 50, lambda = 0
ER = data.frame('PA' = c(0.60342318, 0.40730995, 0.43151551, 0.42945868, 0.41376251, 0.46977133,
                         0.44508141, 0.39361137, 0.50741798, 0.46333152, 0.48548585, 0.55139035,
                         0.3973791 , 0.51789767, 0.49572402, 0.42446405, 0.45636123, 0.44703895,
                         0.47100371, 0.42206866),
                'MI' = c(0.12227291, 0.11315531, 0.07839692, 0.10638374, 0.21484524, 0.1344316 ,
                         0.1393407 , 0.09515905, 0.17554575, 0.15321225, 0.16130084, 0.19485146,
                         0.14203662, 0.15883273, 0.13876313, 0.1812585 , 0.16608292, 0.1841628 ,
                         0.11152983, 0.35605448),
                'MF' = c(0.37311393, 0.23671895, 0.24879795, 0.25523001, 0.24041981, 0.23921114,
                         0.37023574, 0.24214083, 0.26875764, 0.29772383, 0.26602966, 0.24355811,
                         0.23096448, 0.2342779 , 0.30054492, 0.29327136, 0.2472629 , 0.28064305,
                         0.24416775, 0.30563849))

df_long = ER %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PA', 'MI', 'MF'))

ggplot(df_long, aes(x=Variable, y=Value)) + geom_boxplot(fill="blue", alpha=0.2) + 
  xlab("") + ylab("Excess Risk") + scale_y_continuous(limits = c(0, 0.65))



### model 1, d = 10, best results
ER = data.frame('PA' = c(0.0242607593536377, 0.0806679725646973, 0.0229102969169617, 0.0501765012741089, 0.0413554906845093, 0.0399764776229858,
                         0.0524237751960754, 0.0294238328933716, 0.0321440696716309, 0.0303142666816711, 0.124454200267792, 0.0488192439079285, 
                         0.113536059856415, 0.0197805762290955, 0.0723903179168701, 0.000502169132232666, -0.00586152076721191, 0.0635548830032349, -0.00456416606903076, 0.0244720578193665),
                'MI' = c(0.07750809, 0.07230872, 0.14900321, 0.07624233, 0.09278011, 0.16184765,
                         0.08407956, 0.22008151, 0.04987603, 0.07757044, 0.21502608, 0.12579012,
                         0.20843619, 0.17563516, 0.14611799, 0.11678529, 0.15210992, 0.13371092,
                         0.23115081, 0.12282264),
                'MF' = c(0.21101421, 0.20760351, 0.22670203, 0.23798066, 0.20172077, 0.22265977,
                         0.2298041 , 0.23969573, 0.21746057, 0.21873456, 0.22091383, 0.26199692,
                         0.21043152, 0.25341159, 0.26742405, 0.27197212, 0.24592227, 0.20074373,
                         0.26125377, 0.22623104))

df_long = ER %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PA', 'MI', 'MF'))

ggplot(df_long, aes(x=Variable, y=Value)) + geom_boxplot(fill="blue", alpha=0.2) + 
  xlab("") + ylab("Excess Risk")


### model 1, d = 50, lambda = 0
ER = data.frame('PA' = c(0.04097778, 0.02024794, 0.05845785, 0.13843817, 0.06455338, 0.08535707,
                         0.14295441, 0.07582718, 0.09654808, 0.06687731, 0.04248279, 0.05933386,
                         0.07902312, 0.14073068, 0.11072731, 0.08436108, 0.06516278, 0.03213394,
                         0.07518959, 0.02230126),
                'MI' = c(0.12227291, 0.11315531, 0.07839692, 0.10638374, 0.21484524, 0.1344316 ,
                         0.1393407 , 0.09515905, 0.17554575, 0.15321225, 0.16130084, 0.19485146,
                         0.14203662, 0.15883273, 0.13876313, 0.1812585 , 0.16608292, 0.1841628 ,
                         0.11152983, 0.35605448),
                'MF' = c(0.37311393, 0.23671895, 0.24879795, 0.25523001, 0.24041981, 0.23921114,
                         0.37023574, 0.24214083, 0.26875764, 0.29772383, 0.26602966, 0.24355811,
                         0.23096448, 0.2342779 , 0.30054492, 0.29327136, 0.2472629 , 0.28064305,
                         0.24416775, 0.30563849))

df_long = ER %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PA', 'MI', 'MF'))

ggplot(df_long, aes(x=Variable, y=Value)) + geom_boxplot(fill="blue", alpha=0.2) + 
  xlab("") + ylab("Excess Risk") 








