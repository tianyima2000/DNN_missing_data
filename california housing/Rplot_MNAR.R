library(ggplot2)
library(tidyr)

PENN_ZI = c(0.40021052956581116, 0.4255501329898834, 0.40043872594833374, 0.419329971075058, 0.40815892815589905, 0.39838650822639465, 0.42739683389663696, 0.4029354751110077, 0.4104083776473999, 0.4125048518180847, 0.4223300814628601, 0.4228239953517914, 0.39745381474494934, 0.3987322449684143, 0.4233121871948242, 0.4432089030742645, 0.4015134572982788, 0.4076785445213318, 0.4153514802455902, 0.4027557373046875, 0.4294685423374176, 0.40172746777534485, 0.37114447355270386, 0.3857094347476959, 0.4247574806213379, 0.43268832564353943, 0.4079585075378418, 0.4154457151889801, 0.393033891916275, 0.41224947571754456, 0.37081125378608704, 0.42576152086257935, 0.402521550655365, 0.4198080003261566, 0.3785427212715149, 0.4103311598300934, 0.38696858286857605, 0.3997889459133148, 0.384579598903656, 0.38971206545829773, 0.41890183091163635, 0.40232402086257935, 0.41352003812789917, 0.3753836452960968, 0.4407348334789276, 0.43167543411254883, 0.41084304451942444, 0.4601081311702728, 0.386686235666275, 0.39934414625167847) 

NN_ZI = c(0.4201737344264984, 0.45300060510635376, 0.4389663338661194, 0.44936200976371765, 0.41895943880081177, 0.4086342751979828, 0.4412155747413635, 0.4274950325489044, 0.425322026014328, 0.449388325214386, 0.4325082302093506, 0.4318501353263855, 0.4248949885368347, 0.4509561359882355, 0.4612838625907898, 0.4757749140262604, 0.4164232611656189, 0.43610528111457825, 0.4460391104221344, 0.4237520694732666, 0.4534238278865814, 0.43531036376953125, 0.40758785605430603, 0.41033610701560974, 0.4400959312915802, 0.44384756684303284, 0.4181017279624939, 0.43862485885620117, 0.4124595820903778, 0.4165838658809662, 0.38020697236061096, 0.41514644026756287, 0.42791685461997986, 0.4481666386127472, 0.3995017409324646, 0.4424019455909729, 0.42059826850891113, 0.42436596751213074, 0.400773823261261, 0.4354148805141449, 0.4438534379005432, 0.4268588125705719, 0.4420835077762604, 0.40989869832992554, 0.43924441933631897, 0.4540995657444, 0.4317146837711334, 0.48160842061042786, 0.3995421826839447, 0.4273448586463928) 

PENN_MF = c(0.3869185745716095, 0.3841204345226288, 0.38578543066978455, 0.39391452074050903, 0.36804407835006714, 0.3749537467956543, 0.4070679545402527, 0.38636288046836853, 0.3749151825904846, 0.39965978264808655, 0.39357760548591614, 0.3779289424419403, 0.3842562437057495, 0.38908350467681885, 0.3968779146671295, 0.44885048270225525, 0.3733963668346405, 0.5612890720367432, 0.3671950399875641, 0.3658900260925293, 0.38866379857063293, 0.386174738407135, 0.35875260829925537, 0.3753480017185211, 0.3846779763698578, 0.3965761363506317, 0.39590904116630554, 0.3918761610984802, 0.36930355429649353, 0.36723586916923523, 0.3376522660255432, 0.36446642875671387, 0.36558079719543457, 0.37729987502098083, 0.35588327050209045, 0.4205782115459442, 0.36985766887664795, 0.37283405661582947, 0.3604799509048462, 0.3567432165145874, 0.4014454185962677, 0.3842790126800537, 0.3749971389770508, 0.37428221106529236, 0.39225390553474426, 0.41633373498916626, 0.38939300179481506, 0.40792107582092285, 0.3553403615951538, 0.3799855411052704) 

NN_MF = c(0.41872385144233704, 0.3899793028831482, 0.4080212414264679, 0.4142783284187317, 0.37254247069358826, 0.3904683291912079, 0.4335387051105499, 0.40984705090522766, 0.39481204748153687, 0.4197637736797333, 0.4087387025356293, 0.3982156217098236, 0.407391220331192, 0.39682525396347046, 0.42057105898857117, 0.4672652781009674, 0.3851890563964844, 0.4188254475593567, 0.39033111929893494, 0.39041781425476074, 0.3894922733306885, 0.40799522399902344, 0.3723996579647064, 0.3956332802772522, 0.4024394452571869, 0.41417208313941956, 0.41208142042160034, 0.4134517014026642, 0.3933514952659607, 0.3762623369693756, 0.3612959384918213, 0.3849201202392578, 0.38302695751190186, 0.3974475562572479, 0.36229220032691956, 0.4733084738254547, 0.385591983795166, 0.40457388758659363, 0.3797082304954529, 0.38373199105262756, 0.43291744589805603, 0.4062197506427765, 0.3889310359954834, 0.38881298899650574, 0.40194615721702576, 0.44779378175735474, 0.40530630946159363, 0.40563952922821045, 0.3817347288131714, 0.3932231366634369) 

PENN_MICE = c(0.4382041394710541, 0.44522130489349365, 0.4278408885002136, 0.45791977643966675, 0.4725838899612427, 0.4241681396961212, 0.4373832643032074, 0.4544345438480377, 0.4290822148323059, 0.43735674023628235, 0.4373132586479187, 0.4451584219932556, 0.4389137029647827, 0.4432263970375061, 0.4704688787460327, 0.48761749267578125, 0.41924265027046204, 0.4421948194503784, 0.43518638610839844, 0.4430711269378662, 0.4504174292087555, 0.4304273724555969, 0.41309654712677, 0.41061151027679443, 0.44271528720855713, 0.462818443775177, 0.45127224922180176, 0.4305531680583954, 0.4233206808567047, 0.42382243275642395, 0.4271318018436432, 0.4387153387069702, 0.43790191411972046, 0.4698887765407562, 0.42897433042526245, 0.4390236735343933, 0.4288935661315918, 0.4375949800014496, 0.4020029604434967, 0.412075400352478, 0.4632461965084076, 0.43044283986091614, 0.4196210503578186, 0.40786904096603394, 0.443783164024353, 0.4808650612831116, 0.4531174302101135, 0.46484947204589844, 0.4314264953136444, 0.48082584142684937) 

NN_MICE = c(0.4845130741596222, 0.47553378343582153, 0.45654118061065674, 0.511053204536438, 0.4809929132461548, 0.451717734336853, 0.4810051918029785, 0.47803279757499695, 0.48506295680999756, 0.48348531126976013, 0.49326974153518677, 0.4697488844394684, 0.4806274175643921, 0.4746275842189789, 0.5137902498245239, 0.519376277923584, 0.45636436343193054, 0.47167691588401794, 0.48691272735595703, 0.4714672565460205, 0.46087926626205444, 0.4908628761768341, 0.450644314289093, 0.45861831307411194, 0.48009541630744934, 0.5070889592170715, 0.48910918831825256, 0.4632521867752075, 0.45511287450790405, 0.45496901869773865, 0.45541998744010925, 0.4868539869785309, 0.4694153368473053, 0.5032337307929993, 0.4580833911895752, 0.4865969121456146, 0.4651073217391968, 0.48087382316589355, 0.4403134286403656, 0.4597055912017822, 0.4860919415950775, 0.4811913073062897, 0.47503894567489624, 0.4480641484260559, 0.46329161524772644, 0.5106847882270813, 0.5911446213722229, 0.5153629779815674, 0.46644529700279236, 0.48088714480400085) 

Excess_Risk = data.frame('PENN_ZI' = PENN_ZI, 'NN_ZI' = NN_ZI,
                         'PENN_MF' = PENN_MF, 'NN_MF' = NN_MF,
                         'PENN_MICE' = PENN_MICE, 'NN_MICE' = NN_MICE)

df_long = Excess_Risk %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PENN_ZI', 'NN_ZI', 'PENN_MF', 'NN_MF', 'PENN_MICE', 'NN_MICE'))

ggplot(df_long, aes(x=Variable, y=Value, fill=Variable)) + geom_boxplot(alpha=0.2) + 
  xlab("") + ylab("PUV") + theme_bw() + theme(legend.position = "none", text = element_text(size = 16)) + 
  scale_fill_manual(values = c('PENN_ZI' = 'red', 'NN_ZI' = 'blue', 'PENN_MF' = 'red', 
                               'NN_MF' = 'blue',  'PENN_MICE' = 'red', 'NN_MICE' = 'blue')) + ylim(0.335, 0.52)

