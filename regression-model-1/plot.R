library(ggplot2)
library(tidyr)

Excess_Risk = data.frame('PENN_ZI' = c(0.10491247367858891, 0.0040730972290039524, 0.00772268962860112, 0.05676169586181645, 0.019366933822631882, 0.20328004550933843, 0.04493982982635503, 0.030904843330383347, 0.08144433689117436, 0.046100570678710984, 0.001990391731262253, 0.07483823490142827, 0.0068676013946533665, 0.06047554206848149, 0.01488204193115239, 0.07356209945678716, 0.06215841960906987, 0.07905121040344243, 0.05772299957275395, -0.06106548118591304, 0.06906540584564214, -0.006576941490173294, 0.10814185333251958, 0.03500349712371831, 0.05161638450622563, 0.017180635452270554, 0.020141436576843308, 0.14751525115966801, 0.022547676086425827, 0.08938689422607426, 0.06655354690551762, 0.004323794364929245, 0.09525532913208012, 0.07837302875518803, -0.04682652759551997, 0.12001176071166997, 0.06987984371185307, 0.03214879226684575, 0.010968520164489792, -0.01829962539672847, 0.02367420387268071, 0.03994651031494145, 0.015459730148315476, -0.03930239486694331, 0.00854809474945073, 0.09686835002899175, 0.04671950531005864, 0.010619475364685105, 0.033527686119079636, 0.07624764633178716,  -0.045349643707275344, 0.056882574081420945, 0.01893634986877446, 0.038955046653747605, 0.09279604148864751, 0.04285426330566411, 0.01424105358123784, 0.05774076175689702, 0.001718594551086472, 0.06618960094451909, -0.013977692604064895, 0.08098168563842778, -0.006318018913268997, 0.0509702701568604, 0.09680350017547612, 0.09055705261230473, 0.07943124961853032, 0.1072608966827393, -0.06525735664367671, 0.031427933692932175, 0.1137681741714478, 0.06564469528198247, 0.1614673871994019, 0.12108833980560307, 0.055835916519165085, 0.07636721324920659, 0.05706544113159184, 0.06864686203002934, 0.028282835006713913, 0.001977397918701218, 0.011301114082336472, -0.02124898242950435, 0.1274250288009644, 0.09383530807495122, 0.020191027641296433, 0.04463846874237065, 0.03707475852966313, 0.08958573532104497, 0.08754391860961919, 0.1031257648468018, 0.05354507160186772, 0.029917432785034226, 0.01088888835906987, 0.07126171779632573, 0.13735134792327885, 0.10332830142974858, -0.01985900211334224, 0.057880475044250534, 0.06624765586853032, 0.08749134731292729),
                'NN_ZI' = c(0.20104808998107915, 0.18735058498382573, 0.18709702682495122, 0.21299476814270024, 0.13639731597900395, 0.3591208000183106, 0.11767788124084477, 0.11563201141357426, 0.31704445075988774, 0.11479551982879643, 0.12342281532287602, 0.20352776241302495, 0.1492821712493897, 0.2105466861724854, 0.11229760837554936, 0.18642945480346684, 0.1750334043502808, 0.18755836677551274, 0.17035277080535893, 0.018297268867492722, 0.20057149124145512, 0.05347712230682378, 0.23511011791229253, 0.21341450405120854, 0.17707188320159917, 0.16880972576141362, 0.1429873247146607, 0.2594699401855469, 0.17452497673034673, 0.18274338436126714, 0.1779377002716065, 0.1503529090881348, 0.2283750314712525, 0.1806789178848267, 0.07276792716979985, 0.3212356109619141, 0.22708864402771, 0.20204885196685796, 0.1023461360931397, 0.07795686912536626, 0.18523533535003667, 0.19378109169006352, 0.13920219135284428, 0.1563930053710938, 0.0852490205764771, 0.2121427793502808, 0.276949598312378, 0.22932894420623784, 0.12361021232604985, 0.2127582569122315, 0.14103360366821294, 0.1655935783386231, 0.12465019416809087, 0.14003594112396245, 0.23644371223449712, 0.16353900623321538, 0.13378687095642094, 0.2357476491928101, 0.10710413646698003, 0.23249061298370366, 0.18518455219268803, 0.1747871179580689, 0.2135437269210816, 0.16360588264465337, 0.20904584121704106, 0.21402795505523686, 0.19501133155822759, 0.2726826210021973, 0.045263244628906296, 0.1796767253875733, 0.24243266773223882, 0.24066109848022466, 0.3384913940429688, 0.30299396705627446, 0.1749033470153809, 0.16812033843994145, 0.19480700683593755, 0.18230230998992925, 0.13555784416198735, 0.11420161914825444, 0.10857148361206059, 0.14387710285186772, 0.23115117740631108, 0.14783830833435063, 0.22448022556304936, 0.23634512615203862, 0.10571093750000005, 0.18515153121948247, 0.2097013731002808, 0.16779918861389165, 0.13284487915039067, 0.21568734836578374, 0.13098437976837163, 0.22353787612915044, 0.2050988216400147, 0.21695895385742192, 0.051687075614929245, 0.18404550743103032, 0.15531094264984135, 0.306002332687378),
                'PENN_MF' = c(0.055146052360534714, 0.010598494529724167, 0.016219093322753952, 0.05606861305236821, 0.03780658435821538, 0.2148133058547974, 0.051839425086975144, 0.036409928321838425, 0.11775298309326176, 0.04134078216552739, 0.010317637443542527, 0.08562309932708745, 0.019169284820556687, 0.07713551712036137, 0.02174253654479985, 0.09737439346313481, 0.06229241085052495, 0.09603531551361089, 0.04461736869812016, -0.039459751129150344, 0.07431538295745854, -0.013866589546203567, 0.11040194225311284, 0.05144019317626958, 0.1073132295608521, 0.04773433399200444, 0.035628869056701706, 0.16293676090240483, 0.06060178470611577, 0.11011870098114018, 0.06737930965423589, 0.037189437866210984, 0.13721854877471928, 0.08856756877899175, -0.029387639045715286, 0.14639766407012944, 0.10499782752990727, 0.050675346374511765, 0.027378274917602585, -0.026244686126708938, 0.056379272460937546, 0.06468458366394048, 0.044202401161193894, -0.01143162059783931, 0.016510560035705613, 0.10748870563507085, 0.07606680583953862, 0.04337675762176518, 0.05367036056518559, 0.10202462863922124, -0.026941464424133255, 0.07999081802368169, 0.038758232116699265, 0.05987734985351567, 0.09936351966857915, 0.06278140735626225, 0.05290193748474126, 0.052831484794616745, 0.01659281444549565, 0.10418529701232915, -0.012961910247802688, 0.10666997623443608, 0.03041250896453862, 0.05863495063781743, 0.1086647052764893, 0.1260272998809815, 0.1034767169952393, 0.1176291246414185, -0.05386500167846675, 0.034287645339965866, 0.1552096147537232, 0.0879195470809937, 0.1822270889282227, 0.1504660387039185, 0.07449920368194585, 0.1154691715240479, 0.0703484554290772, 0.08015663814544682, 0.06650562477111821, 0.022213294029235886, 0.02788706016540532, -0.0017537336349486843, 0.13504762840271, 0.09758813571929936, 0.039345695495605515, 0.053429438591003464, 0.04448242378234868, 0.09480745983123784, 0.1012707490921021, 0.12479574871063237, 0.06532318782806401, 0.06360931587219243, 0.033188893318176316, 0.057609035491943406, 0.15290970993041997, 0.13189847660064702, -0.01711718845367427, 0.08653671932220464, 0.037215425491333054, 0.10821051788330083),
                'NN_MF' = c(0.2231581945419312, 0.19881017398834233, 0.21604438018798833, 0.3104590911865235, 0.23624785137176518, 0.4555000801086426, 0.23606522274017339, 0.2209444780349732, 0.35644502830505376, 0.21379156303405766, 0.17515678596496587, 0.29333634567260747, 0.1830184001922608, 0.2525538940429688, 0.23343630027771, 0.30229110908508305, 0.25641615581512456, 0.28929157447814946, 0.2670691747665406, 0.20623822402954106, 0.26679213237762456, 0.2025374908447266, 0.3328637619018555, 0.24684341144561772, 0.2701806564331055, 0.23063285541534428, 0.22848482322692876, 0.35147209358215337, 0.26673431587219243, 0.3220450420379639, 0.29637308311462407, 0.21118540954589848, 0.31562466812133794, 0.29861910533905034, 0.22667343807220464, 0.3604630966186524, 0.27927262973785405, 0.23319513988494878, 0.2271855611801148, 0.20897538852691655, 0.22177524757385259, 0.24209137153625493, 0.23213334274291997, 0.21204526615142827, 0.24509902191162114, 0.3429183502197266, 0.2640471000671387, 0.26052947235107426, 0.2409029741287232, 0.3159663219451905, 0.19744749259948735, 0.2836234111785889, 0.25997026157379155, 0.26814849567413335, 0.29990740013122563, 0.2620671529769898, 0.24808783721923833, 0.2595412273406983, 0.18143255901336675, 0.2563416500091553, 0.192426516532898, 0.32990808677673344, 0.2582156200408936, 0.2441637058258057, 0.37100167465209966, 0.3560406703948975, 0.26999314022064214, 0.2851335544586182, 0.13936157417297368, 0.23552425098419194, 0.32673330497741704, 0.28426714134216313, 0.3485750694274903, 0.37711973381042485, 0.2766172428131104, 0.30565066528320317, 0.30990190696716313, 0.2928988475799561, 0.2168197174072266, 0.22550232601165776, 0.22351117324829106, 0.23444135379791264, 0.3174354572296143, 0.29505236339569096, 0.23478276920318608, 0.24601097297668462, 0.2510737915039063, 0.27058334541320805, 0.30952234458923344, 0.3074404735565186, 0.2859445352554322, 0.26756401252746587, 0.22888560485839848, 0.3020557899475098, 0.37638468933105473, 0.3517782230377198, 0.1542642850875855, 0.290951325416565, 0.19930834960937505, 0.318624927520752),
                'PENN_MICE' = c(0.26407535266876225, 0.1552723188400269, 0.21631248188018803, 0.1811965246200562, 0.23834450435638432, 0.3997215766906739, 0.11779124927520757, 0.203689887046814, 0.22868473720550542, 0.29665703964233403, 0.128494574546814, 0.17293734741210942, 0.1535851497650147, 0.17064066123962407, 0.1902386684417725, 0.26899452400207524, 0.16784448814392094, 0.2858144779205323, 0.23448534202575688, 0.1785802383422852, 0.2523773450851441, 0.14949710559844975, 0.3344373245239258, 0.21671385955810551, 0.28626091670989995, 0.13007970046997075, 0.13181801033020024, 0.3486074943542481, 0.1708215017318726, 0.23498852443695073, 0.34687991333007817, 0.1025071878433228, 0.41320724678039555, 0.30633135032653813, 0.1875448961257935, 0.2864983816146851, 0.2242023487091065, 0.16643161964416509, 0.14492578697204594, 0.202591254234314, 0.2728071947097779, 0.3292722244262696, 0.15837533664703374, 0.19066186141967778, 0.307561113357544, 0.232390477180481, 0.22354371738433843, 0.1916279335021973, 0.2588976163864136, 0.2614589471817017,  0.04218883705139165, 0.22788555812835698, 0.10220236968994145, 0.1392060060501099, 0.2672546644210816, 0.26370961856842046, 0.24754233551025395, 0.2509941596984864, 0.24254722785949712, 0.22918243598937993, 0.07317109298706059, 0.21475894641876225, 0.09621997070312505, 0.09073765468597417, 0.18898613643646245, 0.3547446269989014, 0.32113356781005864, 0.10192771148681645, 0.09586174678802495, 0.1915509243011475, 0.3099300403594971, 0.3935789604187012, 0.3604764480590821, 0.22803242397308354, 0.26076932144165044, 0.20528979492187505, 0.3079134960174561, 0.2416281242370606, 0.2861941595077515, 0.20646889400482182, 0.24655993175506596, 0.5105992336273194, 0.29930622768402104, 0.19725961875915532, 0.15861053657531743, 0.21745391082763676, 0.20208592605590825, 0.1285759944915772, 0.22853298377990727, 0.24234183025360112, 0.267851902961731, 0.2783964414596558, 0.1320542831420899, 0.3672587413787842, 0.2624706764221192, 0.27729959678649907, 0.11632163715362553, 0.16001994800567632, 0.22593827438354497, 0.3459257621765137),
                'NN_MICE' = c(0.36305089187622075, 0.322406723022461, 0.42647857856750493, 0.46233744812011723, 0.4720057983398438, 0.5665063400268555, 0.27404375267028813, 0.39310903739929204, 0.41584487152099614, 0.456425859451294, 0.3830973644256592, 0.34182830047607426, 0.29633636665344243, 0.42639036369323735, 0.34771366310119634, 0.44254656028747563, 0.31985111427307134, 0.5770287055969239, 0.42752237510681157, 0.33445615959167485, 0.39279051017761235, 0.4372336406707764, 0.4702813167572022, 0.36898703765869145, 0.5065493125915528, 0.4114567775726319, 0.363711072921753, 0.4940053958892823, 0.37768240165710454, 0.4222642917633057, 0.5330633659362793, 0.22421891880035405, 0.5797502536773682, 0.4784731407165528, 0.4042434234619141, 0.49330325317382817, 0.38615246009826665, 0.32632227134704594, 0.4333276290893555, 0.35740633201599126, 0.3868495960235596, 0.4991030235290528, 0.389134599685669, 0.3820082683563233, 0.3931152362823487, 0.3876130123138428, 0.361107780456543, 0.3668298263549805, 0.43937726211547856, 0.4892217655181885, 0.2616822261810303, 0.5165287990570069, 0.33871026229858403, 0.3742007751464844, 0.4701895256042481, 0.386524154663086, 0.4378096599578858, 0.4909870166778565, 0.34101863098144536, 0.34526105117797856, 0.27415056419372563, 0.422518445968628, 0.2474337358474732, 0.27374751758575444, 0.41058225822448735, 0.49790616226196294, 0.47313995552062993, 0.21912737083435063, 0.2905349273681641, 0.40263481330871587, 0.4712450046539307, 0.5262143154144288, 0.5297650833129883, 0.40408058357238774, 0.474187089920044, 0.3957771797180176, 0.5629217166900635, 0.42008824539184575, 0.38914628219604497, 0.3591234226226807, 0.32760234069824223, 0.3090438385009766, 0.42739911270141606, 0.3839365978240967, 0.3410994548797608, 0.3995582599639893, 0.3638381500244141, 0.4217741031646729, 0.4473754901885987, 0.46990699958801274, 0.40686078262329106, 0.3731736679077149, 0.3120028514862061, 0.548192216873169, 0.44720120620727544, 0.46588273239135747, 0.23891623210906987, 0.33444304656982426, 0.3606612224578858, 0.5177416343688965))

df_long = Excess_Risk %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PENN_ZI', 'NN_ZI', 'PENN_MF', 'NN_MF', 'PENN_MICE', 'NN_MICE'))

ggplot(df_long, aes(x=Variable, y=Value, fill=Variable)) + geom_boxplot(alpha=0.2) + 
  xlab("") + ylab("Excess risk") + theme_bw() + theme(legend.position = "none") + 
  scale_fill_manual(values = c('PENN_ZI' = 'red', 'NN_ZI' = 'blue', 'PENN_MF' = 'red', 
                               'NN_MF' = 'blue',  'PENN_MICE' = 'red', 'NN_MICE' = 'blue'))

