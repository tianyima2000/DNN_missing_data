library(ggplot2)
library(tidyr)


##### Width of PI
PENN_MI = c(8.387702941894531, 8.371865272521973, 8.296306610107422, 8.306360244750977, 8.26598834991455, 8.257857322692871, 8.260461807250977, 8.239852905273438, 8.297035217285156, 8.39169979095459) 

NN_MI = c(8.578575134277344, 8.784053802490234, 8.566757202148438, 8.918902397155762, 8.539484024047852, 8.750639915466309, 8.708028793334961, 8.444607734680176, 8.647055625915527, 8.578457832336426) 

PENN_MF = c(8.324295997619629, 8.21337604522705, 8.324031829833984, 8.375785827636719, 8.258772850036621, 8.332962989807129, 8.266253471374512, 8.250805854797363, 8.342309951782227, 8.212505340576172) 

NN_MF = c(11.260063171386719, 11.336067199707031, 11.195904731750488, 11.202408790588379, 11.199044227600098, 11.236973762512207, 11.245516777038574, 11.243707656860352, 11.210470199584961, 11.22062873840332) 

PENN_II = c(9.47209644317627, 9.459844589233398, 9.500882148742676, 9.374571800231934, 9.475860595703125, 9.398698806762695, 9.367329597473145, 9.522668838500977, 9.559117317199707, 9.389444351196289) 

NN_II = c(12.11189079284668, 11.932979583740234, 12.002840042114258, 12.218774795532227, 12.11669921875, 12.060742378234863, 11.9797945022583, 12.145503044128418, 12.007586479187012, 12.112138748168945) 

Excess_Risk = data.frame('PENN_MI' = PENN_MI, 'NN_MI' = NN_MI,
                         'PENN_MF' = PENN_MF, 'NN_MF' = NN_MF,
                         'PENN_II' = PENN_II, 'NN_II' = NN_II)
df_long = Excess_Risk %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PENN_MI', 'NN_MI', 'PENN_MF', 'NN_MF', 'PENN_II', 'NN_II'))

ggplot(df_long, aes(x=Variable, y=Value, fill=Variable)) + geom_boxplot(alpha=0.2) + 
  xlab("") + ylab("Width of PI") + theme_bw() + theme(legend.position = "none", text = element_text(size = 20)) + 
  scale_fill_manual(values = c('PENN_MI' = 'red', 'NN_MI' = 'blue', 'PENN_MF' = 'red', 
                               'NN_MF' = 'blue',  'PENN_II' = 'red', 'NN_II' = 'blue'))




##### Coverage
PENN_MI = c(0.8998885291151335, 0.9598174000743139, 0.9311003768777536, 0.9578887768282109, 0.9017817647787392, 0.9162729798113842, 0.9002070173576092, 0.9108409858980484, 0.9780066174779269, 0.9570040872657785) 

NN_MI = c(0.901180175876285, 0.9615513916166817, 0.9032503494523771, 0.9008616876338092, 0.9036926942335934, 0.9020294778562202, 0.8998885291151335, 0.9002424049401065, 0.9693012721835907, 0.9691774156448503) 

PENN_MF = c(0.9730700497195534, 0.9440168444892687, 0.9681334819611799, 0.9010917069200418, 0.9038873259373286, 0.9073553090220642, 0.9708229382309748, 0.8984199444414955, 0.9849248898561495, 0.9351522550736946) 

NN_MF = c(0.9006670559300741, 0.903356512199869, 0.8995877346639064, 0.8981014561990197, 0.900879381425058, 0.9001893235663606, 0.9004370366438417, 0.8985968823539819, 0.8998708353238849, 0.9019056213174796) 

PENN_II = c(0.9659040642638498, 0.8993931029601713, 0.9002247111488578, 0.9034449811561123, 0.9669833855300175, 0.9004193428525931, 0.9001539359838633, 0.8999593042801282, 0.9009855441725498, 0.9611621282092114) 

NN_II = c(0.9003308738963498, 0.9511297485712263, 0.9569686996832811, 0.9043119769272963, 0.8994815719164145, 0.9552347081409134, 0.8965267087778899, 0.9003839552700957, 0.9003485676875984, 0.9513243802749615) 

Excess_Risk = data.frame('PENN_MI' = PENN_MI, 'NN_MI' = NN_MI,
                         'PENN_MF' = PENN_MF, 'NN_MF' = NN_MF,
                         'PENN_II' = PENN_II, 'NN_II' = NN_II)
df_long = Excess_Risk %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PENN_MI', 'NN_MI', 'PENN_MF', 'NN_MF', 'PENN_II', 'NN_II'))

ggplot(df_long, aes(x=Variable, y=Value, fill=Variable)) + geom_boxplot(alpha=0.2) + 
  xlab("") + ylab("Coverage") + theme_bw() + theme(legend.position = "none", text = element_text(size = 20)) + 
  scale_fill_manual(values = c('PENN_MI' = 'red', 'NN_MI' = 'blue', 'PENN_MF' = 'red', 
                               'NN_MF' = 'blue',  'PENN_II' = 'red', 'NN_II' = 'blue')) 

