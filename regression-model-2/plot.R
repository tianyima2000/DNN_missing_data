library(ggplot2)
library(tidyr)

Excess_Risk = data.frame('PENN_ZI' = c(0.04749355792999266, 0.12823949337005613, 0.028695802688598615, 0.07529709815979002, 0.15336440086364744, 0.12281153678894041, 0.12172542095184324, 0.11895058631896971, 0.07951674938201903, 0.09786758899688719, 0.06904409408569334, 0.06624398708343504, 0.2090544509887695, 0.2048263359069824, 0.05936799526214598, 0.1385268974304199, -0.013926346302032488, 0.04339991092681883, 0.27418909549713133, 0.22357759952545164, 0.23764358043670653, -0.0045241904258728205, 0.06240592479705809, 0.09690628528594969, 0.012604396343231183, 0.052052597999572736, 0.01014481067657469, 0.05557618618011473, 0.10420427799224852, 0.01625530004501341, 0.19080565452575682, 0.21410844802856444, 0.24573312282562254, 0.09510264873504637, 0.05485961914062498, 0.14357672214508055, 0.10403237819671629, 0.1554653453826904, 0.0982204484939575, 0.06533966541290281, 0.12065551757812498, 0.09690080165863035, 0.06832538127899168, 0.0522144842147827, 0.08167038440704344, 0.1010343837738037, 0.22637377262115477, 0.051672439575195295, 0.0463328170776367, 0.1755909729003906),
                         'NN_ZI' = c(0.1346570062637329, 0.21075914382934569, 0.11820695877075194, 0.19874427795410154, 0.26785037994384764, 0.17555592536926268, 0.19681272983551024, 0.1844844627380371, 0.16490123748779295, 0.17219851493835447, 0.16470430374145506, 0.1708670663833618, 0.2852138090133667, 0.31217036724090574, 0.1287060785293579, 0.2182519245147705, 0.09441993713378904, 0.12376473426818846, 0.34793112754821776, 0.3251377153396606, 0.30104039192199705, 0.08615062713623045, 0.17671595096588133, 0.1516024875640869, 0.07804320335388182, 0.14533517837524412, 0.03580127239227293, 0.15507660388946531, 0.19446776390075682, 0.09826109886169432, 0.25727866172790526, 0.33288572311401365, 0.31340466022491453, 0.18273733139038084, 0.11326299190521238, 0.22759423732757567, 0.21477089405059813, 0.233015398979187, 0.16643605709075926, 0.13643513202667235, 0.15295014858245848, 0.14141557693481444, 0.15661356925964354, 0.1283049392700195, 0.17928956031799315, 0.20209966182708738, 0.2696376848220825, 0.07001338481903074, 0.154532413482666, 0.24141202449798582),
                         'PENN_MF' = c(0.04465446949005125, 0.16568086624145506, 0.020228605270385724, 0.11664221763610838, 0.21843872547149656, 0.12710140228271483, 0.1772677707672119, 0.12891791343688963, 0.10488198280334471, 0.13591049194335936, 0.14792476177215574, 0.12619529247283934, 0.22412524700164793, 0.29918537616729735, 0.061926584243774396, 0.173882942199707, 0.03103641748428343, 0.08155308246612547, 0.32941637516021727, 0.22771606922149656, 0.2539475965499878, 0.0025896239280700506, 0.13133965015411375, 0.08688304901123045, 0.027357201576232892, 0.09388051509857176, 0.04250250339508055, 0.07567689895629881, 0.13528225898742674, 0.04183278560638426, 0.20507309913635252, 0.27534220695495604, 0.22894630908966063, 0.09849808692932127, 0.054178099632263166, 0.1878193426132202, 0.11998734951019285, 0.18814788341522215, 0.1310028839111328, 0.10765169143676756, 0.14830551624298094, 0.10171435356140135, 0.09528646945953367, 0.13223896503448485, 0.10490367889404295, 0.13336346626281737, 0.2302150535583496, 0.049325447082519513, 0.136022310256958, 0.24490509510040281),
                         'NN_MF' = c(0.20213637828826903, 0.25714765071868895, 0.11405370712280272, 0.2377623128890991, 0.3142407941818237, 0.2116557168960571, 0.25420222759246824, 0.2882536458969116, 0.2288051652908325, 0.21013281822204588, 0.22924945831298826, 0.23088369846343992, 0.33338103771209715, 0.3895211029052734, 0.19435141563415526, 0.2751294183731079, 0.14202151775360106, 0.16766212463378904, 0.413693528175354, 0.3497141408920288, 0.3555359649658203, 0.10932097911834715, 0.20033190727233885, 0.16131816387176512, 0.10667977809906004, 0.17769859313964842, 0.14716039180755613, 0.1988296318054199, 0.24662266254425047, 0.13890371799468992, 0.31273732662200926, 0.34489701271057127, 0.37233160018920897, 0.2335266876220703, 0.19932768821716307, 0.25106928825378416, 0.26453898429870604, 0.3234220552444458, 0.2148123788833618, 0.18666098594665526, 0.2400257396697998, 0.20279846668243406, 0.20391796112060545, 0.20955667972564695, 0.23089919567108153, 0.23373578071594237, 0.3249583053588867, 0.16930625915527342, 0.18727598667144774, 0.33651969909667967),
                         'PENN_MICE' = c(0.08369086265563963, 0.26409063816070555, 0.09187648773193358, 0.11938498497009276, 0.22637651443481444, 0.11520658016204832, 0.18228588581085203, 0.18799386501312254, 0.1488328981399536, 0.15438316345214842, 0.20601354122161863, 0.13348458290100096, 0.2281619119644165, 0.2576346206665039, 0.1727286386489868, 0.21569583892822264, 0.030929367542266828, 0.09548423767089842, 0.3338079261779785, 0.21151493072509764, 0.3327100086212158, 0.06567559719085692, 0.1681759166717529, 0.10713539600372313, 0.06027589321136473, 0.09765325069427488, 0.03738145112991331, 0.09501908302307127, 0.17535052776336668, 0.020506362915039045, 0.18331251621246336, 0.2492608833312988, 0.2569491672515869, 0.14827154159545897, 0.10047243118286131, 0.15904961109161375, 0.16704450130462645, 0.19219778060913084, 0.1292406129837036, 0.1173847723007202, 0.15997872829437254, 0.1577595281600952, 0.1639855909347534, 0.18706355571746824, 0.14495609283447264, 0.14461455821990965, 0.25983534336090086, 0.09935806274414061, 0.07852147102355955, 0.24358091831207274),
                         'NN_MICE' = c(0.1746148872375488, 0.22677956104278563, 0.16182992935180662, 0.22361848831176756, 0.2937627840042114, 0.19300244331359862, 0.24754546165466307, 0.27312479496002195, 0.20995293140411375, 0.20365546226501463, 0.21218095302581785, 0.24744079589843748, 0.31533954620361326, 0.37955723285675047, 0.18521450042724608, 0.29400394439697264, 0.10257158756256102, 0.20297537326812742, 0.38454161167144774, 0.3364833402633667, 0.3531250762939453, 0.12608359336853026, 0.20297406196594237, 0.18873236656188963, 0.12006733894348143, 0.16974220752716063, 0.09908364295959471, 0.20505390644073485, 0.271364312171936, 0.1815414237976074, 0.2700828123092651, 0.35253999710083006, 0.3382193851470947, 0.23191199779510496, 0.13499806404113768, 0.2320073652267456, 0.26127622604370115, 0.28448484420776365, 0.2192144203186035, 0.1923955488204956, 0.20576880455017088, 0.3434052276611328, 0.263186674118042, 0.23737559795379637, 0.25551209926605223, 0.17769859313964842, 0.32131371974945067, 0.15125678062438963, 0.1846091556549072, 0.2947451877593994))

df_long = Excess_Risk %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")
df_long$Variable = factor(df_long$Variable, levels = c('PENN_ZI', 'NN_ZI', 'PENN_MF', 'NN_MF', 'PENN_MICE', 'NN_MICE'))

ggplot(df_long, aes(x=Variable, y=Value, fill=Variable)) + geom_boxplot(alpha=0.2) + 
  xlab("") + ylab("Excess risk") + theme_bw() + theme(legend.position = "none") + 
  scale_fill_manual(values = c('PENN_ZI' = 'red', 'NN_ZI' = 'blue', 'PENN_MF' = 'red', 
                               'NN_MF' = 'blue',  'PENN_MICE' = 'red', 'NN_MICE' = 'blue'))

